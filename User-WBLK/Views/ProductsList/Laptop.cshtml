@model ProductListViewModel
@{
    ViewData["Title"] = "Laptop";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mx-auto px-4">
    <!-- Filters -->
    <div class="bg-white rounded-lg p-4">
        <div class="mb-4">
            <h2 class="font-semibold mb-2">Chọn theo tiêu chí:</h2>
            <div class="flex flex-wrap gap-2">
                <!-- Nhu cầu -->
                <div class="relative">
                    <select class="px-4 py-2 border rounded-md w-48" onchange="window.location.href=this.value">
                        <option value="@Url.Action("Laptop", "ProductsList")">Nhu cầu</option>
                        @{
                            var gamingUrl = Url.Action("Laptop", "ProductsList", new
                            {
                                usage = "gaming",
                                priceRange = Model.PriceRange,
                                brand = Model.AdditionalFilters.GetValueOrDefault("brand"),
                                cpuType = Model.AdditionalFilters.GetValueOrDefault("cpuType"),
                                ram = Model.AdditionalFilters.GetValueOrDefault("ram"),
                                gpu = Model.AdditionalFilters.GetValueOrDefault("gpu")
                            });
                            var graphicsUrl = Url.Action("Laptop", "ProductsList", new
                            {
                                usage = "graphics",
                                priceRange = Model.PriceRange,
                                brand = Model.AdditionalFilters.GetValueOrDefault("brand"),
                                cpuType = Model.AdditionalFilters.GetValueOrDefault("cpuType"),
                                ram = Model.AdditionalFilters.GetValueOrDefault("ram"),
                                gpu = Model.AdditionalFilters.GetValueOrDefault("gpu")
                            });
                            var workstationUrl = Url.Action("Laptop", "ProductsList", new
                            {
                                usage = "workstation",
                                priceRange = Model.PriceRange,
                                brand = Model.AdditionalFilters.GetValueOrDefault("brand"),
                                cpuType = Model.AdditionalFilters.GetValueOrDefault("cpuType"),
                                ram = Model.AdditionalFilters.GetValueOrDefault("ram"),
                                gpu = Model.AdditionalFilters.GetValueOrDefault("gpu")
                            });
                            var officeUrl = Url.Action("Laptop", "ProductsList", new
                            {
                                usage = "office",
                                priceRange = Model.PriceRange,
                                brand = Model.AdditionalFilters.GetValueOrDefault("brand"),
                                cpuType = Model.AdditionalFilters.GetValueOrDefault("cpuType"),
                                ram = Model.AdditionalFilters.GetValueOrDefault("ram"),
                                gpu = Model.AdditionalFilters.GetValueOrDefault("gpu")
                            });
                        }
                        <option value="@gamingUrl" selected="@(Model.AdditionalFilters["usage"] == "gaming")">Laptop Gaming</option>
                        <option value="@graphicsUrl" selected="@(Model.AdditionalFilters["usage"] == "graphics")">Laptop Đồ hoạ</option>
                        <option value="@workstationUrl" selected="@(Model.AdditionalFilters["usage"] == "workstation")">Laptop Workstation</option>
                        <option value="@officeUrl" selected="@(Model.AdditionalFilters["usage"] == "office")">Laptop Văn phòng</option>
                    </select>
                </div>

                <!-- Hãng sản xuất -->
                <div class="relative">
                    <select class="px-4 py-2 border rounded-md w-48" onchange="window.location.href=this.value">
                        <option value="">Hãng sản xuất</option>
                        @{
                            var asusUrl = Url.Action("Laptop", "ProductsList", new { brand = "asus" });
                            var acerUrl = Url.Action("Laptop", "ProductsList", new { brand = "acer" });
                            var msiUrl = Url.Action("Laptop", "ProductsList", new { brand = "msi" });
                            var lenovoUrl = Url.Action("Laptop", "ProductsList", new { brand = "lenovo" });
                            var dellUrl = Url.Action("Laptop", "ProductsList", new { brand = "dell" });
                            var hpUrl = Url.Action("Laptop", "ProductsList", new { brand = "hp" });
                            var gigabyteUrl = Url.Action("Laptop", "ProductsList", new { brand = "gigabyte" });
                        }
                        <option value="@asusUrl" selected="@(Model.AdditionalFilters["brand"] == "asus")">ASUS</option>
                        <option value="@acerUrl" selected="@(Model.AdditionalFilters["brand"] == "acer")">Acer</option>
                        <option value="@msiUrl" selected="@(Model.AdditionalFilters["brand"] == "msi")">MSI</option>
                        <option value="@lenovoUrl" selected="@(Model.AdditionalFilters["brand"] == "lenovo")">Lenovo</option>
                        <option value="@dellUrl" selected="@(Model.AdditionalFilters["brand"] == "dell")">Dell</option>
                        <option value="@hpUrl" selected="@(Model.AdditionalFilters["brand"] == "hp")">HP</option>
                        <option value="@gigabyteUrl" selected="@(Model.AdditionalFilters["brand"] == "gigabyte")">Gigabyte</option>
                    </select>
                </div>

                <!-- CPU -->
                <div class="relative">
                    <select class="px-4 py-2 border rounded-md w-48" onchange="window.location.href=this.value">
                        <option value="">Loại CPU</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { cpuType = "intel-i3" })"
                                selected="@(Model.AdditionalFilters["cpuType"] == "intel-i3")">Intel Core i3</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { cpuType = "intel-i5" })"
                                selected="@(Model.AdditionalFilters["cpuType"] == "intel-i5")">Intel Core i5</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { cpuType = "intel-i7" })"
                                selected="@(Model.AdditionalFilters["cpuType"] == "intel-i7")">Intel Core i7</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { cpuType = "intel-i9" })"
                                selected="@(Model.AdditionalFilters["cpuType"] == "intel-i9")">Intel Core i9</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { cpuType = "amd-r3" })"
                                selected="@(Model.AdditionalFilters["cpuType"] == "amd-r3")">AMD Ryzen 3</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { cpuType = "amd-r5" })"
                                selected="@(Model.AdditionalFilters["cpuType"] == "amd-r5")">AMD Ryzen 5</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { cpuType = "amd-r7" })"
                                selected="@(Model.AdditionalFilters["cpuType"] == "amd-r7")">AMD Ryzen 7</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { cpuType = "amd-r9" })"
                                selected="@(Model.AdditionalFilters["cpuType"] == "amd-r9")">AMD Ryzen 9</option>
                    </select>
                </div>

                <!-- RAM -->
                <div class="relative">
                    <select class="px-4 py-2 border rounded-md w-48" onchange="window.location.href=this.value">
                        <option value="">RAM</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { ram = "8gb" })"
                                selected="@(Model.AdditionalFilters["ram"] == "8gb")">8GB</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { ram = "16gb" })"
                                selected="@(Model.AdditionalFilters["ram"] == "16gb")">16GB</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { ram = "32gb" })"
                                selected="@(Model.AdditionalFilters["ram"] == "32gb")">32GB</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { ram = "64gb" })"
                                selected="@(Model.AdditionalFilters["ram"] == "64gb")">64GB</option>
                    </select>
                </div>

                <!-- GPU -->
                <div class="relative">
                    <select class="px-4 py-2 border rounded-md w-48" onchange="window.location.href=this.value">
                        <option value="">Card màn hình</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { gpu = "nvidia" })"
                                selected="@(Model.AdditionalFilters["gpu"] == "nvidia")">NVIDIA</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { gpu = "amd" })"
                                selected="@(Model.AdditionalFilters["gpu"] == "amd")">AMD</option>
                        <option value="@Url.Action("Laptop", "ProductsList", new { gpu = "intel" })"
                                selected="@(Model.AdditionalFilters["gpu"] == "intel")">Intel</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Price Range -->
        <div>
            <h2 class="font-semibold mb-2">Khoảng giá:</h2>
            <div class="flex flex-wrap gap-2">
                @{
                    var priceRanges = new Dictionary<string, string>() {
                {"duoi-10-trieu", "Dưới 10 triệu"},
                {"10-15-trieu", "10 - 15 triệu"},
                {"15-20-trieu", "15 - 20 triệu"},
                {"20-25-trieu", "20 - 25 triệu"},
                {"25-35-trieu", "25 - 35 triệu"},
                {"35-trieu", "Trên 35 triệu"}
                };

                    foreach (var range in priceRanges)
                    {
                        var url = Url.Action("Laptop", "ProductsList", new
                        {
                            priceRange = range.Key,
                            usage = Model.AdditionalFilters.GetValueOrDefault("usage"),
                            brand = Model.AdditionalFilters.GetValueOrDefault("brand"),
                            cpuType = Model.AdditionalFilters.GetValueOrDefault("cpuType"),
                            ram = Model.AdditionalFilters.GetValueOrDefault("ram"),
                            gpu = Model.AdditionalFilters.GetValueOrDefault("gpu")
                        });

                        <a href="@url"
                           class="px-4 py-2 bg-gray-100 rounded-md hover:bg-gray-200 @(Model.PriceRange == range.Key ? "bg-blue-600 text-white" : "")">
                            @range.Value
                        </a>
                    }
                }
            </div>
        </div>
    </div>

    <!-- Sort Options -->
    <div class="flex gap-4 mb-6">
        <button class="px-4 py-2 bg-white rounded-md hover:bg-gray-50">Tăng dần</button>
        <button class="px-4 py-2 bg-white rounded-md hover:bg-gray-50">Giảm dần</button>
        <button class="px-4 py-2 bg-white rounded-md hover:bg-gray-50">Từ A - Z</button>
    </div>

    <!-- Products Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
        @for (int i = 0; i < 15; i++)
        {
            <partial name="_ProductCard" />
        }
    </div>

    <!-- Pagination -->
    <div class="flex justify-center items-center space-x-2 my-8">
        @{
            string GetPageUrl(int pageNum)
            {
                var routeValues = new Dictionary<string, object>();

                if (!string.IsNullOrEmpty(Model.Category))
                {
                    routeValues.Add("category", Model.Category);
                }

                if (!string.IsNullOrEmpty(Model.PriceRange))
                {
                    routeValues.Add("priceRange", Model.PriceRange);
                }

                routeValues.Add("page", pageNum);

                return Url.Action("Laptop", routeValues);
            }
        }

        <a href="@GetPageUrl(Model.CurrentPage - 1)"
           class="px-4 py-2 bg-white rounded-md hover:bg-gray-50 @(Model.CurrentPage == 1 ? "opacity-50 cursor-not-allowed" : "")"
        @(Model.CurrentPage == 1 ? "disabled" : "")>
            <span class="sr-only">Previous</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
        </a>

        @for (int i = 1; i <= Model.TotalPages; i++)
        {
            if (i == Model.CurrentPage)
            {
                <a href="@GetPageUrl(i)"
                   class="px-4 py-2 bg-blue-600 text-white rounded-md">@i</a>
            }
            else if (i <= 3 || i == Model.TotalPages || Math.Abs(i - Model.CurrentPage) <= 1)
            {
                <a href="@GetPageUrl(i)"
                   class="px-4 py-2 bg-white hover:bg-gray-50 rounded-md">@i</a>
            }
            else if (i == 4 || i == Model.TotalPages - 1)
            {
                <span class="px-4 py-2">...</span>
            }
        }

        <a href="@GetPageUrl(Model.CurrentPage + 1)"
           class="px-4 py-2 bg-white rounded-md hover:bg-gray-50 @(Model.CurrentPage == Model.TotalPages ? "opacity-50 cursor-not-allowed" : "")"
        @(Model.CurrentPage == Model.TotalPages ? "disabled" : "")>
            <span class="sr-only">Next</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
        </a>
    </div>
</div>

